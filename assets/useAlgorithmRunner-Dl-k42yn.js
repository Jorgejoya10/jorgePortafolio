import{r as C}from"./index-C6JFRcRn.js";const E=new TextEncoder;new TextDecoder;function c(t){return E.encode(t??"")}const f="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function k(t){return t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toUpperCase()}function w(t,n){const e=f.indexOf(t);if(e<0)return t;const r=(e+n+26)%26;return f[r]}function g(t,n){const e=k(t),r=(n%26+26)%26;return[...e].map(o=>w(o,r)).join("")}const S={id:"caesar",name:"César",year:-50,kind:"classical",category:"classics",async encrypt(t){const n=String(t.plaintext??""),e=Number(t.shift??0),r=g(n,e);return{output:c(r),meta:{shift:(e%26+26)%26}}},async decrypt(t){const n=String(t.ciphertext??""),e=Number(t.shift??0),r=g(n,-e);return{output:c(r),meta:{shift:(-e%26+26)%26}}}},y="ABCDEFGHIJKLMNOPQRSTUVWXYZ",h="ABCDEFGHIJKLMNÑOPQRSTUVWXYZ";function b(t){return t.replace(/[áàäâ]/gi,"a").replace(/[éèëê]/gi,"e").replace(/[íìïî]/gi,"i").replace(/[óòöô]/gi,"o").replace(/[úùüû]/gi,"u").replace(/ç/gi,"c")}function m(t){return b(t).toUpperCase()}function v(t,n){const e=m(t).split("").filter(r=>n.includes(r)).join("");if(!e.length)throw new Error("Clave inválida: no contiene letras del alfabeto seleccionado.");return e}function d(t,n,e,r){const o=e.length,x=m(t),a=v(n,e);let u=0;const i=[];for(const l of x){const s=e.indexOf(l);if(s===-1){i.push(l);continue}const p=e.indexOf(a[u%a.length]);u++;const A=r?(s+p)%o:(s-p+o)%o;i.push(e[A])}return i.join("")}const N={id:"vigenere",name:"Vigenère",year:1553,kind:"classical",category:"classics",async encrypt(t){const n=t.alphabet==="en"?y:h,e=d(String(t.text??""),String(t.key??""),n,!0);return{output:c(e),meta:{alphabet:t.alphabet??"es"}}},async decrypt(t){const n=t.alphabet==="en"?y:h,e=d(String(t.text??""),String(t.key??""),n,!1);return{output:c(e),meta:{alphabet:t.alphabet??"es"}}}},T={caesar:S,vigenere:N},K=t=>T[t];function I(){return{run:C.useCallback(async(n,e,r)=>{const o=K(n);if(!o)throw new Error(`Algorithm not implemented: ${n}`);if(e==="encrypt")return o.encrypt(r);if(e==="decrypt"&&o.decrypt)return o.decrypt(r);if(e==="sign"&&o.sign)return o.sign(r);if(e==="verify"&&o.verify)return{output:new Uint8Array,meta:{ok:await o.verify(r)}};throw new Error(`Mode not supported for ${n}: ${e}`)},[])}}export{I as u};
