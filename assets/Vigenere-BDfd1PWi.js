import{r as t,j as e}from"./index-C6JFRcRn.js";import{u as A}from"./useAlgorithmRunner-Dl-k42yn.js";function w({algoId:s}){const{run:c}=A(),[l,g]=t.useState("ATAQUE AL AMANECER"),[n,j]=t.useState("CLAVE"),[o,f]=t.useState("es"),[N,d]=t.useState(""),[u,p]=t.useState(""),v=t.useMemo(()=>{const a=o==="es"?"ABCDEFGHIJKLMNÑOPQRSTUVWXYZ":"ABCDEFGHIJKLMNOPQRSTUVWXYZ",r=b(n,a);if(!r)return"";let m=0;return[...h(l)].map(y=>{if(a.includes(y)){const C=r[m%r.length];return m++,C}return" "}).join("")},[l,n,o]);async function x(a){p("");try{const r=await c(s,a,{text:l,key:n,alphabet:o});d(new TextDecoder().decode(r.output))}catch(r){d(""),p(r?.message??String(r))}}const i=t.useMemo(()=>b(n,o==="es"?"ABCDEFGHIJKLMNÑOPQRSTUVWXYZ":"ABCDEFGHIJKLMNOPQRSTUVWXYZ").length>0,[n,o]);return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("p",{className:"text-neutral-300",children:["Cifrado polialfabético que usa una ",e.jsx("b",{children:"tabla de Vigenère"})," (tabula recta) y una clave que se repite sobre el texto. Aquí trabajamos por defecto con el alfabeto español (incluye Ñ)."]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("label",{className:"flex flex-col gap-1 md:col-span-2",children:[e.jsx("span",{className:"text-sm text-neutral-400",children:"Texto"}),e.jsx("textarea",{rows:4,className:"w-full rounded-md bg-neutral-900 border border-neutral-700 p-3",value:l,onChange:a=>g(a.target.value),spellCheck:!1})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("label",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm text-neutral-400",children:"Clave"}),e.jsx("input",{className:"rounded-md bg-neutral-900 border border-neutral-700 p-2",value:n,onChange:a=>j(a.target.value)}),!i&&e.jsx("span",{className:"text-xs text-red-400",children:"La clave debe contener al menos una letra del alfabeto seleccionado."})]}),e.jsxs("label",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm text-neutral-400",children:"Alfabeto"}),e.jsxs("select",{value:o,onChange:a=>f(a.target.value),className:"rounded-md bg-neutral-900 border border-neutral-700 p-2",children:[e.jsx("option",{value:"es",children:"Español (A–Z + Ñ)"}),e.jsx("option",{value:"en",children:"Inglés (A–Z)"})]})]})]})]}),e.jsxs("div",{className:"rounded-md border border-neutral-700 bg-neutral-900 p-3 text-xs font-mono text-neutral-300",children:[e.jsx("div",{className:"mb-1 text-neutral-400",children:"Clave repetida (sobre letras):"}),e.jsx("pre",{className:"whitespace-pre-wrap break-words",children:v})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>x("encrypt"),disabled:!i,className:"px-4 py-2 rounded-md bg-blue-600 hover:bg-blue-500 disabled:opacity-40",children:"Cifrar"}),e.jsx("button",{onClick:()=>x("decrypt"),disabled:!i,className:"px-4 py-2 rounded-md bg-neutral-700 hover:bg-neutral-600 disabled:opacity-40",children:"Descifrar"}),e.jsx("button",{onClick:()=>{d("")},className:"px-4 py-2 rounded-md border border-neutral-700",children:"Limpiar salida"})]}),u&&e.jsx("div",{className:"rounded-md border border-red-700 bg-red-950/40 p-3 text-red-300",children:u}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm text-neutral-400 mb-1",children:"Salida"}),e.jsx("textarea",{rows:4,readOnly:!0,className:"w-full rounded-md bg-neutral-900 border border-neutral-700 p-3",value:N})]}),e.jsxs("div",{className:"rounded-xl border border-neutral-700 bg-neutral-900 p-4 text-sm text-neutral-300",children:[e.jsx("b",{children:"Notas:"})," se ignoran tildes (á→a, ü→u) y se preservan espacios/puntuación. Vigenère es vulnerable a Kasiski/Friedman y análisis de frecuencia por sub-alfabetos."]})]})}function h(s){return E(s).toUpperCase()}function b(s,c){return h(s).split("").filter(l=>c.includes(l)).join("")}function E(s){return s.replace(/[áàäâ]/gi,"a").replace(/[éèëê]/gi,"e").replace(/[íìïî]/gi,"i").replace(/[óòöô]/gi,"o").replace(/[úùüû]/gi,"u").replace(/ç/gi,"c")}export{w as default};
